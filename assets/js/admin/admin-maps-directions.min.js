var gmb_data;!function(e){"use strict";function t(t){if("undefined"==typeof t[0])return!1;var s=new google.maps.places.Autocomplete(t[0]);s.bindTo("bounds",map),google.maps.event.addDomListener(t[0],"keydown",function(e){13==e.keyCode&&e.preventDefault()}),google.maps.event.addListener(s,"place_changed",function(){return n=s.getPlace(),o=e(t).parents(".gmb-destination-fieldset").find(".gmb-directions-latitude"),a=e(t).parents(".gmb-destination-fieldset").find(".gmb-directions-longitude"),d=e(t).parents(".gmb-destination-fieldset").find(".gmb-directions-place_id"),r=e(t).parents(".gmb-destination-fieldset").find(".gmb-directions-address"),o.val(n.geometry.location.lat()),a.val(n.geometry.location.lng()),d.val(n.place_id),r.val(n.formatted_address),n.geometry?void i():void alert("Error: Place not found!")})}function i(){e("#gmb_directions_group_repeat").find(".cmb-repeatable-grouping").each(function(t,i){s[t]&&s[t].setMap(null),s[t]=new google.maps.DirectionsRenderer,s[t].setMap(window.map);var n,o=e(this).find(".cmb-repeat-row"),a=o.first().find('.gmb-directions-latitude[data-iterator="0"]').val(),d=o.first().find('.gmb-directions-longitude[data-iterator="0"]').val(),r=o.first().find('.gmb-directions-address[data-iterator="0"]').val();n=r?r:a+","+d;var c,g=o.last().find(".gmb-directions-latitude").val(),m=o.last().find(".gmb-directions-longitude").val(),f=o.last().find(".gmb-directions-address").val();c=r?f:g+","+m;var p=e(this).find(".gmb-travel-mode").val(),u=[];o.not(":first").not(":last").each(function(t,i){var n,o=e(this).find(".gmb-directions-address").val(),a=e(this).find(".gmb-directions-latitude").val(),d=e(this).find(".gmb-directions-longitude").val();n=o?o:a+","+d,u.push({location:n,stopover:!0})});var v={origin:n,destination:c,waypoints:u,optimizeWaypoints:!0,travelMode:google.maps.TravelMode[p]};l.route(v,function(e,i){i==google.maps.DirectionsStatus.OK&&(s[t].setOptions({preserveViewport:!0}),s[t].setDirections(e))})})}var n,o,a,d,r,s=[],l=new google.maps.DirectionsService;e(window).on("load",function(){i(),e(".gmb-directions-autocomplete").each(function(i,n){t(e(this))}),e("#gmb_directions_group_repeat").on("cmb2_add_row",function(i,n){t(e(n).find(".gmb-directions-autocomplete"))}),e(".cmb-type-destination").on("cmb2_remove_row",function(e,t){i()}),e("body").on("change",".gmb-travel-mode",function(e,t){i()})})}(jQuery);