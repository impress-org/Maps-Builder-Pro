!function($,gmb){gmb.set_custom_snazzy_map=function(){var custom_theme_json=$("#gmb_theme_json");if(""!==custom_theme_json.val())try{var custom_theme_json_val=$.parseJSON(custom_theme_json.val());map.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP,styles:eval(custom_theme_json_val)})}catch(err){alert("Invalid JSON"),custom_theme_json.val("").focus()}},gmb.set_map_theme=function(){var preset_theme=$("#gmb_theme"),map_theme_input_val=parseInt(preset_theme.val()),map_type_select_field=$("#gmb_type"),custom_theme_json_wrap=$(".cmb2-id-gmb-theme-json"),custom_theme_json=$("#gmb_theme_json");$(".custom-snazzy-toggle").on("click",function(e){e.preventDefault(),preset_theme.val("custom"),custom_theme_json_wrap.show(),custom_theme_json.val("").focus(),gmb.set_custom_snazzy_map()}),custom_theme_json.on("change",function(){gmb.set_custom_snazzy_map()}),"none"!==preset_theme.val()&&map_type_select_field.val("RoadMap"),"none"===preset_theme.val()?custom_theme_json.val(""):"custom"===preset_theme.val()?(custom_theme_json_wrap.show(),gmb.set_custom_snazzy_map()):(custom_theme_json_wrap.hide(),$.getJSON(gmb_data.snazzy,function(data){$.each(data,function(index){data[index].id===map_theme_input_val&&(map_theme_input_val=eval(data[index].json),$("#gmb_theme_json").val(data[index].json))}),map.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP,styles:map_theme_input_val})}))},gmb.add_markers=function(map){gmb.clear_main_markers();var time=500,markers=[],cluster_markers=$("#gmb_marker_cluster1").prop("checked");if($("#gmb_markers_group_repeat").find(".cmb-repeatable-grouping").each(function(index){var marker_icon=gmb_data.default_marker,marker_label="",custom_marker_icon=$("#gmb_markers_group_"+index+"_marker").val(),custom_marker_img=$("#gmb_markers_group_"+index+"_marker_img").val();if(custom_marker_img)marker_icon=custom_marker_img;else if(custom_marker_icon.length>0&&custom_marker_icon.length>0){var custom_label=$("#gmb_markers_group_"+index+"_label").val();marker_icon=eval("("+custom_marker_icon+")"),marker_label=custom_label}var marker_lat=parseFloat($("#gmb_markers_group_"+index+"_lat").val()),marker_lng=parseFloat($("#gmb_markers_group_"+index+"_lng").val()),place_id=$("#gmb_markers_group_"+index+"_place_id").val(),position=new google.maps.LatLng(marker_lat,marker_lng),marker_args={position:position,map:map,zIndex:index,icon:marker_icon,custom_label:marker_label};place_id&&"enabled"===gmb_data.signed_in_option&&(delete marker_args.position,marker_args.place={location:{lat:marker_lat,lng:marker_lng},placeId:place_id},marker_args.attribution={source:gmb_data.site_name,webUrl:gmb_data.site_url});var location_marker=new Marker(marker_args);markers.push(location_marker),location_marker.setVisible(!0),google.maps.event.addListener(location_marker,"click",function(){gmb.get_info_window_content(index,location_marker)}),time+=500,$("#gmb_markers_group_"+index+"_title").parents(".cmb-repeatable-grouping").find(".cmb-remove-group-row").each(function(){google.maps.event.addDomListener($(this)[0],"click",function(){$(this).parents(".cmb-repeatable-grouping").data("index");info_bubble.close(),location_marker.setVisible(!1)})})}),cluster_markers===!0)var markerCluster=new MarkerClusterer(map,markers)},gmb.get_marker_index=function(){var e=$("#gmb_markers_group_repeat"),a=e.find(" div.cmb-repeatable-grouping"),t=e.find(".cmb-add-group-row.button"),m=parseInt(a.last().attr("data-iterator")),_=a.first().find("input,textarea").val();return _&&0===m?(t.trigger("click"),m=1):0!==m&&(t.trigger("click"),m=parseInt(e.find(" div.cmb-repeatable-grouping").last().attr("data-iterator"))),m},gmb.set_map_theme=function(){var preset_theme=$("#gmb_theme"),map_theme_input_val=parseInt(preset_theme.val()),map_type_select_field=$("#gmb_type"),custom_theme_json_wrap=$(".cmb2-id-gmb-theme-json"),custom_theme_json=$("#gmb_theme_json");$(".custom-snazzy-toggle").on("click",function(e){e.preventDefault(),preset_theme.val("custom"),custom_theme_json_wrap.show(),custom_theme_json.val("").focus(),set_custom_snazzy_map()}),custom_theme_json.on("change",function(){set_custom_snazzy_map()}),"none"!==preset_theme.val()&&map_type_select_field.val("RoadMap"),"none"===preset_theme.val()?custom_theme_json.val(""):"custom"===preset_theme.val()?(custom_theme_json_wrap.show(),set_custom_snazzy_map()):(custom_theme_json_wrap.hide(),$.getJSON(gmb_data.snazzy,function(data){$.each(data,function(index){data[index].id===map_theme_input_val&&(map_theme_input_val=eval(data[index].json),$("#gmb_theme_json").val(data[index].json))}),map.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP,styles:map_theme_input_val})}))}}(jQuery,window.MapsBuilderAdmin||(window.MapsBuilderAdmin={}));