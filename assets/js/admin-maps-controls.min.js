/**
 *  Maps Directions
 *
 *  @description: Adds directions functionality to the maps builder
 *  @copyright: http://opensource.org/licenses/gpl-2.0.php GNU Public License
 *  @since: 2.0
 */
var gmb_data,trafficLayer=new google.maps.TrafficLayer,transitLayer=new google.maps.TransitLayer,bicycleLayer=new google.maps.BicyclingLayer,placeSearchAutocomplete;!function(e){"use strict";/**
	 * Set Map Layers
	 *
	 * @description Toggles various layers on and off
	 * @param layer obj
	 */
function o(e){if(!e)return!1;var o=e.val(),t=e.prop("checked");switch(o){case"traffic":trafficLayer.setMap(t?window.map:null);break;case"transit":transitLayer.setMap(t?window.map:null);break;case"bicycle":bicycleLayer.setMap(t?window.map:null)}}/**
	 * Toggle Places Search Field
	 * @descrition: Adds and removes the places search field from the map preview
	 * @param input
	 */
function t(o){
//Setup search or Toggle show/hide?
"undefined"==typeof placeSearchAutocomplete&&o.prop("checked")===!0?(n(),//hasn't been setup yet, so set it up
e("#places-search").show()):o.prop("checked")===!0&&"object"==typeof placeSearchAutocomplete?e("#places-search").show():e("#places-search").hide()}/**
	 * Set up Places Search Field
	 *
	 * @description Creates the Google Map custom control with autocomplete enabled
	 *
	 */
function n(){
// Sets a listener on a radio button to change the filter type on Places
// Autocomplete.
function e(e,o){var t=document.getElementById(e);google.maps.event.addDomListener(t,"click",function(){placeSearchAutocomplete.setTypes(o)})}{var o=/** @type {HTMLInputElement} */document.getElementById("pac-input");document.getElementById("type-selector")}map.controls[google.maps.ControlPosition.TOP_CENTER].push(document.getElementById("places-search")),placeSearchAutocomplete=new google.maps.places.Autocomplete(o),placeSearchAutocomplete.bindTo("bounds",map);var t=new google.maps.InfoWindow,n=new google.maps.Marker({map:map,anchorPoint:new google.maps.Point(0,-29)});google.maps.event.addListener(placeSearchAutocomplete,"place_changed",function(){t.close(),n.setVisible(!1);var e=placeSearchAutocomplete.getPlace();if(!e.geometry)return void window.alert("Autocomplete's returned place contains no geometry");
// If the place has a geometry, then present it on a map.
e.geometry.viewport?map.fitBounds(e.geometry.viewport):(map.setCenter(e.geometry.location),map.setZoom(17)),n.setIcon(/** @type {google.maps.Icon} */{url:e.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)}),n.setPosition(e.geometry.location),n.setVisible(!0);var o="";e.address_components&&(o=[e.address_components[0]&&e.address_components[0].short_name||"",e.address_components[1]&&e.address_components[1].short_name||"",e.address_components[2]&&e.address_components[2].short_name||""].join(" ")),t.setContent("<div><strong>"+e.name+"</strong><br>"+o),t.open(map,n)}),e("changetype-all",[]),e("changetype-address",["address"]),e("changetype-establishment",["establishment"]),e("changetype-geocode",["geocode"]),
//Tame the enter key to not save the widget while using the autocomplete input
google.maps.event.addDomListener(o,"keydown",function(e){13==e.keyCode&&e.preventDefault()})}/**
	 * Kick it off on Window Load
	 */
e(window).on("load",function(){
//Layers
e(".cmb2-id-gmb-layers input").on("change",function(){o(e(this))}),
//Loop through layers
e(".cmb2-id-gmb-layers input:checkbox").each(function(){o(e(this))});
//Places Search
var n=e(".cmb2-id-gmb-places-search input");n.on("change",function(){t(e(this))}),t(n)})}(jQuery);